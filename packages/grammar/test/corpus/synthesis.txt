==================
simple define-synthesis
==================

2026-01-07T12:00Z define-synthesis "Personal profile" ^profile-synthesis
  sources: lore where subject = ^self

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (metadata
        (key)
        (value
          (query
            (query_entity)
            (query_conditions
              (query_condition
                (field_condition
                  (condition_field)
                  (link))))))))))

==================
define-synthesis with tags
==================

2026-01-07T12:00Z define-synthesis "Bio synthesis" ^bio #profile #career
  sources: lore where subject = ^self

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (tag)
      (tag)
      (metadata
        (key)
        (value
          (query
            (query_entity)
            (query_conditions
              (query_condition
                (field_condition
                  (condition_field)
                  (link))))))))))

==================
define-synthesis with prompt content
==================

2026-01-07T12:00Z define-synthesis "Profile synthesis" ^profile
  sources: lore where subject = ^self

  # Prompt
  Write a narrative bio from these facts.

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (metadata
        (key)
        (value
          (query
            (query_entity)
            (query_conditions
              (query_condition
                (field_condition
                  (condition_field)
                  (link)))))))
      (content
        (markdown_header
          (md_indicator)
          (md_heading_text))
        (content_line
          (content_text))))))

==================
define-synthesis with multiple metadata
==================

2026-01-07T12:00Z define-synthesis "Profile" ^profile
  sources: lore where subject = ^self
  format: "markdown"

  # Prompt
  Generate profile.

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (metadata
        (key)
        (value
          (query
            (query_entity)
            (query_conditions
              (query_condition
                (field_condition
                  (condition_field)
                  (link)))))))
      (metadata
        (key)
        (value
          (quoted_value)))
      (content
        (markdown_header
          (md_indicator)
          (md_heading_text))
        (content_line
          (content_text))))))

==================
define-synthesis with multi-line prompt
==================

2026-01-07T12:00Z define-synthesis "CV synthesis" ^cv
  sources: lore where #career

  # Prompt
  Create a structured CV with:
  1. Education section
  2. Experience section
  Sort by date descending.

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (metadata
        (key)
        (value
          (query
            (query_entity)
            (query_conditions
              (query_condition
                (tag_condition
                  (tag)))))))
      (content
        (markdown_header
          (md_indicator)
          (md_heading_text))
        (content_line
          (content_text))
        (content_line
          (content_text))
        (content_line
          (content_text))
        (content_line
          (content_text))))))

==================
simple actualize-synthesis
==================

2026-01-07T12:01Z actualize-synthesis ^profile
  updated: 2026-01-07T12:01Z

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (link)
      (metadata
        (key)
        (value
          (datetime_value))))))

==================
actualize-synthesis with only updated field
==================

2026-01-08T10:00Z actualize-synthesis ^bio-synthesis
  updated: 2026-01-08T10:00Z

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (link)
      (metadata
        (key)
        (value
          (datetime_value))))))

==================
multiple entries in file
==================

2026-01-07T12:00Z define-synthesis "Profile" ^profile
  sources: lore where subject = ^self

  # Prompt
  Generate profile.

2026-01-07T12:01Z actualize-synthesis ^profile
  updated: 2026-01-07T12:01Z

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (metadata
        (key)
        (value
          (query
            (query_entity)
            (query_conditions
              (query_condition
                (field_condition
                  (condition_field)
                  (link)))))))
      (content
        (markdown_header
          (md_indicator)
          (md_heading_text))
        (content_line
          (content_text)))))
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (link)
      (metadata
        (key)
        (value
          (datetime_value))))))

==================
complex sources query
==================

2026-01-07T12:00Z define-synthesis "Career summary" ^career
  sources: lore where subject = ^self and #career, journal where subject = ^self

---

(source_file
  (entry
    (data_entry
      (timestamp
        (timestamp_date)
        (timestamp_t)
        (timestamp_time)
        (timestamp_tz))
      (data_directive)
      (title)
      (link)
      (metadata
        (key)
        (value
          (value_array
            (query
              (query_entity)
              (query_conditions
                (query_condition
                  (field_condition
                    (condition_field)
                    (link)))
                (query_condition
                  (tag_condition
                    (tag)))))
            (query
              (query_entity)
              (query_conditions
                (query_condition
                  (field_condition
                    (condition_field)
                    (link)))))))))))
